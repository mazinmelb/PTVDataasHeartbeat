{  // create undo group    // afterwards move captions comp to position 1100,650  app.beginUndoGroup("Text");  var viewableSecs = 5;  var transitionTime = -.01;var compName = "my captions";var avPos = [270,940];    //var avPos = [0,0];    // Prompt user to select text file  var myFile = File.openDialog("Please select input text file.");  if (myFile != null){    // open file    var fileOK = myFile.open("r");    if (fileOK){      // create project if necessary      var proj = app.project;      if(!proj) proj = app.newProject();      // create new comp named 'my text comp'      var compW = 2356; // comp width      var compH = 1188; // comp height      var compL = 5;  // comp length (seconds)      var compRate = 24; // comp frame rate      // var compBG = [48/255,63/255,84/255] // comp background color        var myItemCollection = app.project.items;      var myComp = myItemCollection.addComp(compName,compW,compH,1,compL,compRate);                // Creating background layer       var compSettings    = cs = [1280, 720, 1, 10, 24];       var backgroundLayer = myComp.layers.addSolid([93, 5, 2], "Background", cs[0], cs[1], cs[2]);                var before, start, end,i = 0;      // myComp.bgColor = compBG;      // read text lines and create text layer for each      // until end-of-file is reached      var text;      while (!myFile.eof){            text = myFile.readln();            if (text !== "") {                i =i+1;                thisOne = myComp.layers.addText(text);                thisOne.property("Position").setValue(avPos);                beforebefore = (i-1)*viewableSecs;                before = (i-transitionTime)*viewableSecs;                start = i*viewableSecs;                end = (i+transitionTime)*viewableSecs;                after = (i+1)*viewableSecs;                thisOne.inPoint = beforebefore;                thisOne.outPoint = after;                                thisOne.property("Opacity").setValueAtTime(before,0);                thisOne.property("Opacity").setValueAtTime(start,100);                thisOne.property("Opacity").setValueAtTime(end,100);                thisOne.property("Opacity").setValueAtTime(after,0);                var mySourceText = thisOne.property("ADBE Text Properties").property("ADBE Text Document");                var myTextDoc = mySourceText.value;                myTextDoc.fillColor = [245/255,207/255,27/255];                mySourceText.setValue(myTextDoc);                                    // put timing marker                 backgroundLayer.property("Opacity").setValueAtTime(start,100);            }      }       myComp.duration = end;      // close the file before exiting      myFile.close();    }else{      alert("File open failed!");    }   }else{    alert("No text file selected.");  }  app.endUndoGroup();}